#C:\Python27>python C:\Users\win1001\Desktop\discoverNetworks.py
from _winreg import *

def val2addr(val):
    addr = ''
    for ch in val:
        addr += '%02x '% ord(ch)
        
    addr = addr.strip(" ").replace(" ", ":")[0:17]
    return addr

def printNets():
    print ("[*] printNets")
    net = "SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Unmanaged"
    key = OpenKey(HKEY_LOCAL_MACHINE, net)
    print ("[*] Networks you have joined")
    for i in range(100):
        try:
            guid = EnumKey(key, i)
            netKey = OpenKey(key, str(guid))
            
            (n, desc, t) = EnumValue(netKey, 3)
            (n, name, t) = EnumValue(netKey, 4)
            (n, addr, t) = EnumValue(netKey, 5)
            
            macAddr = val2addr(addr)
            netName = str(name)
            netDesc = str(desc)
            
            print ("[+] " + netName + " " + macAddr + " ==> " +  netDesc)
            
            CloseKey(netKey)
        except Exception as e:
            print (e)
            break
    

def main():
    printNets()


if __name__ == "__main__":
    main()