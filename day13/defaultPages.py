#!/usr/bin/python3

from ftplib import FTP

def returnDefault():
    try:
        ftp = FTP(host, timeout=100)
        ftp.login(username, password)
        ftp.set_debuglevel(2)
        print("login succesfull on host:{} with {}:{}".format(host, username, password))
        # print("[*] Running nlst...")

        print("[+] Welcome")
        print(ftp.getwelcome())

        print("[+] Setting passive mode")
        # ftp.set_pasv(True)

        print("[+] sencmd LIST")
        # print(ftp.sendcmd('LIST'))
        # print(ftp.retrlines('LIST'))
        # print(ftp.dir())
        # ftp.nlst()

        print("[+] Doing nlst")
        dirList = ftp.nlst()
        print("[*] NLST Done: files {}".format(dirList))
        ftp.quit()
    except Exception as e:
        dirlist = []
        print(e)
        print ('[-] Could not list directory contents.')
        print ('[-] Skipping to next target.')
        ftp.quit()
        return
    retList = []
    for filename in dirList:
        fn = filename.lower()
        if '.php' in fn or '.htm' in fn or '.html' in fn or '.asp' in fn:
            print ('[+] Found default page: {}'.format(filename))
            retList.append(filename)
    return retList

host = '192.168.10.6'
username = 'user1'
password = 'user1#!!'

returnDefault()


print("Closing connection. Script Completed.")

#here is how i made this script working
#https://stackoverflow.com/questions/58575896/python-fptlib-mlsd-generator-iteration-error