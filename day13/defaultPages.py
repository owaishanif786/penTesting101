#!/usr/bin/python3

from ftplib import FTP

def returnDefault(ftp):
    dirList = []
    try:
        print("[*] Trying mlsd")
        dirList = ftp.mlsd('.', facts=['type']
        print(dirList) 
    except Exception as e:
        print("Failed ot list content {}".format(e))
        dirlist = []
        print ('[-] Could not list directory contents.')
        print ('[-] Skipping to next target.')
        return
    retList = []
    for name in dirList:
        print(name)
        fn = name.lower()
        if '.php' in fn or '.htm' in fn or '.html' in fn or '.asp' in fn:
            print ('[+] Found default page: {}'.format(name))
            retList.append(name)
    return retList

host = '192.168.10.6'
username = 'user1'
password = 'user1#!!'

ftp = FTP(host)
ftp.login(username, password)
print("login succesfull on host:{} with {}:{}".format(host, username, password))


returnDefault(ftp)
ftp.quit()

print("Script Completed.")
